import{n as q,g as D,h as ee,x as te,v as I,c as E,w as N,j as ae,p as ne,k as oe,t as j,L as se,u as le,b as z,M as ie,m as re,I as de}from"./index-CDxJsEB3.js";/* empty css              */import{s as ue,c as ce}from"./index-BY2WvT1f.js";/* empty css              *//* empty css              */import{P as me}from"./index-BYPyhoAA.js";/* empty css              *//* empty css              */import"./index-DYpDMpii.js";import"./index-BvfrUZFn.js";import{S as fe}from"./index-i20rsCUJ.js";import{N as pe}from"./index-CvtmVt3d.js";import{u as ve}from"./member-_9lrcxvK.js";import{h as R,w as $,a,s as he,m as L,r as b,A as _e,B as ge,x as be,_ as xe,c as w,b as g,k as l,o as B,F as ke,l as Ve,t as C,n as O,C as A,q as Ce,g as y}from"./index-CYNoNFn7.js";import{u as U,L as ye}from"./use-touch-CoLEfbaL.js";import{u as Te,T as Pe,a as Se}from"./index-eYf9Q_JG.js";import{P as we}from"./index--jaruAqB.js";import{B as Be}from"./index-BTb55al6.js";import"./use-route-5Jp667pb.js";import"./use-id-zzKfe8rB.js";import"./use-placeholder-CGcD_-36.js";import"./index-RZEO5At_.js";import"./interceptor-SwkErRcB.js";const[H,$e]=E("checkbox-group"),Le={max:q,shape:I("round"),disabled:Boolean,iconSize:q,direction:String,modelValue:te(),checkedColor:String},K=Symbol(H);var Ge=R({name:H,props:Le,emits:["change","update:modelValue"],setup(t,{emit:d,slots:i}){const{children:s,linkChildren:_}=ee(K),c=n=>d("update:modelValue",n),u=(n={})=>{typeof n=="boolean"&&(n={checked:n});const{checked:v,skipDisabled:m}=n,h=s.filter(f=>f.props.bindGroup?f.props.disabled&&m?f.checked.value:v!=null?v:!f.checked.value:!1).map(f=>f.name);c(h)};return $(()=>t.modelValue,n=>d("change",n)),U({toggleAll:u}),D(()=>t.modelValue),_({props:t,updateValue:c}),()=>{var n;return a("div",{class:$e([t.direction])},[(n=i.default)==null?void 0:n.call(i)])}}});const Ee=N(Ge),[Ne,Re]=E("checkbox"),Ue=oe({},ce,{shape:String,bindGroup:j,indeterminate:{type:Boolean,default:null}});var Fe=R({name:Ne,props:Ue,emits:["change","update:modelValue"],setup(t,{emit:d,slots:i}){const{parent:s}=ae(K),_=n=>{const{name:v}=t,{max:m,modelValue:V}=s.props,h=V.slice();if(n)!(m&&h.length>=+m)&&!h.includes(v)&&(h.push(v),t.bindGroup&&s.updateValue(h));else{const f=h.indexOf(v);f!==-1&&(h.splice(f,1),t.bindGroup&&s.updateValue(h))}},c=L(()=>s&&t.bindGroup?s.props.modelValue.indexOf(t.name)!==-1:!!t.modelValue),u=(n=!c.value)=>{s&&t.bindGroup?_(n):d("update:modelValue",n),t.indeterminate!==null&&d("change",n)};return $(()=>t.modelValue,n=>{t.indeterminate===null&&d("change",n)}),U({toggle:u,props:t,checked:c}),D(()=>t.modelValue),()=>a(ue,he({bem:Re,role:"checkbox",parent:s,checked:c.value,onToggle:u},t),ne(i,["default","icon"]))}});const Me=N(Fe),[qe,T,ze]=E("list"),Oe={error:Boolean,offset:re(300),loading:Boolean,disabled:Boolean,finished:Boolean,scroller:Object,errorText:String,direction:I("down"),loadingText:{type:String,default:""},finishedText:String,immediateCheck:j};var Ae=R({name:qe,props:Oe,emits:["load","update:error","update:loading"],setup(t,{emit:d,slots:i}){const s=b(t.loading),_=b(),c=b(),u=Te(),n=se(_),v=L(()=>t.scroller||n.value),m=()=>{be(()=>{if(s.value||t.finished||t.disabled||t.error||(u==null?void 0:u.value)===!1)return;const{direction:p}=t,k=+t.offset,r=z(v);if(!r.height||ie(_))return;let e=!1;const x=z(c);p==="up"?e=r.top-x.top<=k:e=x.bottom-r.bottom<=k,e&&(s.value=!0,d("update:loading",!0),d("load"))})},V=()=>{if(t.finished){const p=i.finished?i.finished():t.finishedText;if(p)return a("div",{class:T("finished-text")},[p])}},h=()=>{d("update:error",!1),m()},f=()=>{if(t.error){const p=i.error?i.error():t.errorText;if(p)return a("div",{role:"button",class:T("error-text"),tabindex:0,onClick:h},[p])}},G=()=>{if(s.value&&!t.finished&&!t.disabled)return a("div",{class:T("loading")},[i.loading?i.loading():t.loadingText!=null&&a(ye,{class:T("loading-icon")},{default:()=>[t.loadingText||ze("loading")]})])};return $(()=>[t.loading,t.finished,t.error],m),u&&$(u,p=>{p&&m()}),_e(()=>{s.value=t.loading}),ge(()=>{t.immediateCheck&&m()}),U({check:m}),le("scroll",m,{target:v,passive:!0}),()=>{var p;const k=(p=i.default)==null?void 0:p.call(i),r=a("div",{ref:c,class:T("placeholder")},null);return a("div",{ref:_,role:"feed",class:T(),"aria-busy":s.value},[t.direction==="down"?k:r,G(),V(),f(),t.direction==="up"?k:r])}}});const De=N(Ae),Ie={class:"page members-page"},je={class:"filter-tabs"},He={class:"member-list"},Ke=["onClick"],Xe=["src"],Ye={class:"member-content"},Je={class:"member-header"},Qe={class:"member-name"},We={class:"member-meta"},Ze={class:"member-footer"},et={key:0,class:"expiry-date"},tt={class:"filter-panel"},at={class:"filter-header"},nt={class:"filter-section"},ot={class:"filter-footer"},st={__name:"Members",setup(t){const d=ve(),i=L(()=>d.stats),s=b(""),_=b("all"),c=b(!1),u=b([]),n=b(!1),v=b(!1),m=b(!0),V=L(()=>{let r=d.members;if(_.value!=="all"&&(r=r.filter(e=>e.status===_.value)),u.value.length>0&&(r=r.filter(e=>u.value.includes(e.membershipType))),s.value){const e=s.value.toLowerCase();r=r.filter(x=>x.name.toLowerCase().includes(e)||x.phone.includes(e)||x.id.toLowerCase().includes(e))}return r}),h=()=>{},f=()=>{setTimeout(()=>{n.value=!1},1e3)},G=()=>{v.value=!1,m.value=!0},p=()=>{u.value=[]},k=()=>{c.value=!1};return(r,e)=>{const x=pe,F=de,X=fe,P=Se,Y=Pe,J=De,Q=me,M=Be,S=Me,W=Ee,Z=we;return B(),w("div",Ie,[a(x,{title:"會員管理"}),a(X,{modelValue:s.value,"onUpdate:modelValue":e[1]||(e[1]=o=>s.value=o),placeholder:"搜尋會員姓名、電話...","show-action":"",onSearch:h},{action:g(()=>[a(F,{name:"filter-o",size:"20",onClick:e[0]||(e[0]=o=>c.value=!0)})]),_:1},8,["modelValue"]),l("div",je,[a(Y,{active:_.value,"onUpdate:active":e[2]||(e[2]=o=>_.value=o),shrink:""},{default:g(()=>[a(P,{title:"全部",name:"all"}),a(P,{title:`有效 (${i.value.active})`,name:"active"},null,8,["title"]),a(P,{title:`待審核 (${i.value.pending})`,name:"pending"},null,8,["title"]),a(P,{title:`已過期 (${i.value.expired})`,name:"expired"},null,8,["title"])]),_:1},8,["active"])]),a(Q,{modelValue:n.value,"onUpdate:modelValue":e[4]||(e[4]=o=>n.value=o),onRefresh:f},{default:g(()=>[a(J,{loading:v.value,"onUpdate:loading":e[3]||(e[3]=o=>v.value=o),finished:m.value,"finished-text":"沒有更多了",onLoad:G},{default:g(()=>[l("div",He,[(B(!0),w(ke,null,Ve(V.value,o=>(B(),w("div",{key:o.id,class:"member-card",onClick:lt=>r.$router.push(`/admin/member/${o.id}`)},[l("img",{src:o.avatar,class:"member-avatar"},null,8,Xe),l("div",Ye,[l("div",Je,[l("span",Qe,C(o.name),1),l("span",{class:O(["membership-badge",o.membershipType])},C(A(d).membershipTypes[o.membershipType].label),3)]),l("div",We,[l("span",null,C(o.phone),1),e[7]||(e[7]=l("span",{class:"divider"},"|",-1)),l("span",null,C(o.id),1)]),l("div",Ze,[l("span",{class:O(["status-tag",o.status])},C(A(d).statusTypes[o.status].label),3),o.expiryDate?(B(),w("span",et," 到期："+C(o.expiryDate),1)):Ce("",!0)])]),a(F,{name:"arrow",class:"arrow-icon"})],8,Ke))),128))])]),_:1},8,["loading","finished"])]),_:1},8,["modelValue"]),a(Z,{show:c.value,"onUpdate:show":e[6]||(e[6]=o=>c.value=o),position:"right",style:{width:"80%",height:"100%"}},{default:g(()=>[l("div",tt,[l("div",at,[e[9]||(e[9]=l("span",null,"篩選條件",-1)),a(M,{type:"primary",size:"small",plain:"",onClick:p},{default:g(()=>[...e[8]||(e[8]=[y("重置",-1)])]),_:1})]),l("div",nt,[e[14]||(e[14]=l("div",{class:"filter-title"},"會籍類型",-1)),a(W,{modelValue:u.value,"onUpdate:modelValue":e[5]||(e[5]=o=>u.value=o),direction:"horizontal"},{default:g(()=>[a(S,{name:"normal",shape:"square"},{default:g(()=>[...e[10]||(e[10]=[y("普通會員",-1)])]),_:1}),a(S,{name:"silver",shape:"square"},{default:g(()=>[...e[11]||(e[11]=[y("銀級會員",-1)])]),_:1}),a(S,{name:"gold",shape:"square"},{default:g(()=>[...e[12]||(e[12]=[y("金級會員",-1)])]),_:1}),a(S,{name:"enterprise",shape:"square"},{default:g(()=>[...e[13]||(e[13]=[y("企業會員",-1)])]),_:1})]),_:1},8,["modelValue"])]),l("div",ot,[a(M,{type:"primary",block:"",round:"",onClick:k},{default:g(()=>[...e[15]||(e[15]=[y("確認篩選",-1)])]),_:1})])])]),_:1},8,["show"])])}}},$t=xe(st,[["__scopeId","data-v-b263826d"]]);export{$t as default};
