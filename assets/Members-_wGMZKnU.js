import{n as K,k as Z,l as ce,h as de,g as G,c as z,w as D,j as Y,f as A,t as O,D as ue,I as ee,e as j,x as fe,p as H,N as me,u as ve,b as J,O as he,m as be,E as ge}from"./index-M2RwkOmD.js";/* empty css              *//* empty css              */import{u as ke,T as _e,P as pe,a as Ce}from"./index-Bh7GwHjR.js";/* empty css              */import"./index-CjUHWvAL.js";import{f as ne,F as xe}from"./index-Ci3T-9dp.js";import{N as ye}from"./index-BPqN2r_8.js";import{u as Ve}from"./member-gjzfnCIz.js";import{g as B,h as N,a as t,m as S,b as x,s as te,z as Se,A as Pe,u as Te,_ as we,c as E,w as C,k as b,o as F,F as Ie,l as Be,t as P,n as Q,B as W,q as $e,f as T}from"./index-BCHZ0ZDp.js";import{u as Le}from"./use-id-CcAXWJTY.js";import{u as U,L as Re,B as Ee}from"./use-touch-BDVozqpq.js";import{P as Fe}from"./index-k7JcCHgp.js";import"./use-placeholder-DZ-FIvA6.js";const[ae,Ge]=z("checkbox-group"),Ne={max:K,shape:G("round"),disabled:Boolean,iconSize:K,direction:String,modelValue:de(),checkedColor:String},le=Symbol(ae);var ze=B({name:ae,props:Ne,emits:["change","update:modelValue"],setup(e,{emit:s,slots:o}){const{children:d,linkChildren:f}=ce(le),r=i=>s("update:modelValue",i),h=(i={})=>{typeof i=="boolean"&&(i={checked:i});const{checked:v,skipDisabled:g}=i,k=d.filter(a=>a.props.bindGroup?a.props.disabled&&g?a.checked.value:v!=null?v:!a.checked.value:!1).map(a=>a.name);r(k)};return N(()=>e.modelValue,i=>s("change",i)),U({toggleAll:h}),Z(()=>e.modelValue),f({props:e,updateValue:r}),()=>{var i;return t("div",{class:Ge([e.direction])},[(i=o.default)==null?void 0:i.call(o)])}}});const De=D(ze),oe={name:Y,disabled:Boolean,iconSize:K,modelValue:Y,checkedColor:String,labelPosition:String,labelDisabled:Boolean};var Ae=B({props:A({},oe,{bem:ue(Function),role:String,shape:String,parent:Object,checked:Boolean,bindGroup:O,indeterminate:{type:Boolean,default:null}}),emits:["click","toggle"],setup(e,{emit:s,slots:o}){const d=x(),f=a=>{if(e.parent&&e.bindGroup)return e.parent.props[a]},r=S(()=>{if(e.parent&&e.bindGroup){const a=f("disabled")||e.disabled;if(e.role==="checkbox"){const p=f("modelValue").length,c=f("max"),_=c&&p>=+c;return a||_&&!e.checked}return a}return e.disabled}),h=S(()=>f("direction")),i=S(()=>{const a=e.checkedColor||f("checkedColor");if(a&&(e.checked||e.indeterminate)&&!r.value)return{borderColor:a,backgroundColor:a}}),v=S(()=>e.shape||f("shape")||"round"),g=a=>{const{target:p}=a,c=d.value,_=c===p||(c==null?void 0:c.contains(p));!r.value&&(_||!e.labelDisabled)&&s("toggle"),s("click",a)},y=()=>{var a,p;const{bem:c,checked:_,indeterminate:m}=e,n=e.iconSize||f("iconSize");return t("div",{ref:d,class:c("icon",[v.value,{disabled:r.value,checked:_,indeterminate:m}]),style:v.value!=="dot"?{fontSize:j(n)}:{width:j(n),height:j(n),borderColor:(a=i.value)==null?void 0:a.borderColor}},[o.icon?o.icon({checked:_,disabled:r.value}):v.value!=="dot"?t(ee,{name:m?"minus":"success",style:i.value},null):t("div",{class:c("icon--dot__icon"),style:{backgroundColor:(p=i.value)==null?void 0:p.backgroundColor}},null)])},k=()=>{const{checked:a}=e;if(o.default)return t("span",{class:e.bem("label",[e.labelPosition,{disabled:r.value}])},[o.default({checked:a,disabled:r.value})])};return()=>{const a=e.labelPosition==="left"?[k(),y()]:[y(),k()];return t("div",{role:e.role,class:e.bem([{disabled:r.value,"label-disabled":e.labelDisabled},h.value]),tabindex:r.value?void 0:0,"aria-checked":e.checked,onClick:g},[a])}}});const[Oe,Ue]=z("checkbox"),qe=A({},oe,{shape:String,bindGroup:O,indeterminate:{type:Boolean,default:null}});var Me=B({name:Oe,props:qe,emits:["change","update:modelValue"],setup(e,{emit:s,slots:o}){const{parent:d}=fe(le),f=i=>{const{name:v}=e,{max:g,modelValue:y}=d.props,k=y.slice();if(i)!(g&&k.length>=+g)&&!k.includes(v)&&(k.push(v),e.bindGroup&&d.updateValue(k));else{const a=k.indexOf(v);a!==-1&&(k.splice(a,1),e.bindGroup&&d.updateValue(k))}},r=S(()=>d&&e.bindGroup?d.props.modelValue.indexOf(e.name)!==-1:!!e.modelValue),h=(i=!r.value)=>{d&&e.bindGroup?f(i):s("update:modelValue",i),e.indeterminate!==null&&s("change",i)};return N(()=>e.modelValue,i=>{e.indeterminate===null&&s("change",i)}),U({toggle:h,props:e,checked:r}),Z(()=>e.modelValue),()=>t(Ae,te({bem:Ue,role:"checkbox",parent:d,checked:r.value,onToggle:h},e),H(o,["default","icon"]))}});const je=D(Me),[Ke,w,He]=z("list"),Xe={error:Boolean,offset:be(300),loading:Boolean,disabled:Boolean,finished:Boolean,scroller:Object,errorText:String,direction:G("down"),loadingText:{type:String,default:""},finishedText:String,immediateCheck:O};var Ye=B({name:Ke,props:Xe,emits:["load","update:error","update:loading"],setup(e,{emit:s,slots:o}){const d=x(e.loading),f=x(),r=x(),h=ke(),i=me(f),v=S(()=>e.scroller||i.value),g=()=>{Te(()=>{if(d.value||e.finished||e.disabled||e.error||(h==null?void 0:h.value)===!1)return;const{direction:c}=e,_=+e.offset,m=J(v);if(!m.height||he(f))return;let n=!1;const V=J(r);c==="up"?n=m.top-V.top<=_:n=V.bottom-m.bottom<=_,n&&(d.value=!0,s("update:loading",!0),s("load"))})},y=()=>{if(e.finished){const c=o.finished?o.finished():e.finishedText;if(c)return t("div",{class:w("finished-text")},[c])}},k=()=>{s("update:error",!1),g()},a=()=>{if(e.error){const c=o.error?o.error():e.errorText;if(c)return t("div",{role:"button",class:w("error-text"),tabindex:0,onClick:k},[c])}},p=()=>{if(d.value&&!e.finished&&!e.disabled)return t("div",{class:w("loading")},[o.loading?o.loading():e.loadingText!=null&&t(Re,{class:w("loading-icon")},{default:()=>[e.loadingText||He("loading")]})])};return N(()=>[e.loading,e.finished,e.error],g),h&&N(h,c=>{c&&g()}),Se(()=>{d.value=e.loading}),Pe(()=>{e.immediateCheck&&g()}),U({check:g}),ve("scroll",g,{target:v,passive:!0}),()=>{var c;const _=(c=o.default)==null?void 0:c.call(o),m=t("div",{ref:r,class:w("placeholder")},null);return t("div",{ref:f,role:"feed",class:w(),"aria-busy":d.value},[e.direction==="down"?_:m,p(),y(),a(),e.direction==="up"?_:m])}}});const Je=D(Ye),[Qe,I,We]=z("search"),Ze=A({},ne,{label:String,shape:G("square"),leftIcon:G("search"),clearable:O,actionText:String,background:String,showAction:Boolean});var en=B({name:Qe,props:Ze,emits:["blur","focus","clear","search","cancel","clickInput","clickLeftIcon","clickRightIcon","update:modelValue"],setup(e,{emit:s,slots:o,attrs:d}){const f=Le(),r=x(),h=()=>{o.action||(s("update:modelValue",""),s("cancel"))},i=l=>{l.keyCode===13&&(ge(l),s("search",e.modelValue))},v=()=>e.id||`${f}-input`,g=()=>{if(o.label||e.label)return t("label",{class:I("label"),for:v(),"data-allow-mismatch":"attribute"},[o.label?o.label():e.label])},y=()=>{if(e.showAction){const l=e.actionText||We("cancel");return t("div",{class:I("action"),role:"button",tabindex:0,onClick:h},[o.action?o.action():l])}},k=()=>{var l;return(l=r.value)==null?void 0:l.blur()},a=()=>{var l;return(l=r.value)==null?void 0:l.focus()},p=l=>s("blur",l),c=l=>s("focus",l),_=l=>s("clear",l),m=l=>s("clickInput",l),n=l=>s("clickLeftIcon",l),V=l=>s("clickRightIcon",l),$=Object.keys(ne),q=()=>{const l=A({},d,H(e,$),{id:v()}),L=M=>s("update:modelValue",M);return t(xe,te({ref:r,type:"search",class:I("field",{"with-message":l.errorMessage}),border:!1,labelAlign:"left",onBlur:p,onFocus:c,onClear:_,onKeypress:i,onClickInput:m,onClickLeftIcon:n,onClickRightIcon:V,"onUpdate:modelValue":L},l),H(o,["left-icon","right-icon"]))};return U({focus:a,blur:k}),()=>{var l;return t("div",{class:I({"show-action":e.showAction}),style:{background:e.background}},[(l=o.left)==null?void 0:l.call(o),t("div",{class:I("content",e.shape)},[g(),q()]),y()])}}});const nn=D(en),tn={class:"page members-page"},an={class:"filter-tabs"},ln={class:"member-list"},on=["onClick"],sn=["src"],rn={class:"member-content"},cn={class:"member-header"},dn={class:"member-name"},un={class:"member-meta"},fn={class:"member-footer"},mn={key:0,class:"expiry-date"},vn={class:"filter-panel"},hn={class:"filter-header"},bn={class:"filter-section"},gn={class:"filter-footer"},kn={__name:"Members",setup(e){const s=Ve(),o=S(()=>s.stats),d=x(""),f=x("all"),r=x(!1),h=x([]),i=x(!1),v=x(!1),g=x(!0),y=S(()=>{let m=s.members;if(f.value!=="all"&&(m=m.filter(n=>n.status===f.value)),h.value.length>0&&(m=m.filter(n=>h.value.includes(n.membershipType))),d.value){const n=d.value.toLowerCase();m=m.filter(V=>V.name.toLowerCase().includes(n)||V.phone.includes(n)||V.id.toLowerCase().includes(n))}return m}),k=()=>{},a=()=>{setTimeout(()=>{i.value=!1},1e3)},p=()=>{v.value=!1,g.value=!0},c=()=>{h.value=[]},_=()=>{r.value=!1};return(m,n)=>{const V=ye,$=ee,q=nn,l=Ce,L=_e,M=Je,ie=pe,X=Ee,R=je,se=De,re=Fe;return F(),E("div",tn,[t(V,{title:"會員管理"}),t(q,{modelValue:d.value,"onUpdate:modelValue":n[1]||(n[1]=u=>d.value=u),placeholder:"搜尋會員姓名、電話...","show-action":"",onSearch:k},{action:C(()=>[t($,{name:"filter-o",size:"20",onClick:n[0]||(n[0]=u=>r.value=!0)})]),_:1},8,["modelValue"]),b("div",an,[t(L,{active:f.value,"onUpdate:active":n[2]||(n[2]=u=>f.value=u),shrink:""},{default:C(()=>[t(l,{title:"全部",name:"all"}),t(l,{title:`有效 (${o.value.active})`,name:"active"},null,8,["title"]),t(l,{title:`待審核 (${o.value.pending})`,name:"pending"},null,8,["title"]),t(l,{title:`已過期 (${o.value.expired})`,name:"expired"},null,8,["title"])]),_:1},8,["active"])]),t(ie,{modelValue:i.value,"onUpdate:modelValue":n[4]||(n[4]=u=>i.value=u),onRefresh:a},{default:C(()=>[t(M,{loading:v.value,"onUpdate:loading":n[3]||(n[3]=u=>v.value=u),finished:g.value,"finished-text":"沒有更多了",onLoad:p},{default:C(()=>[b("div",ln,[(F(!0),E(Ie,null,Be(y.value,u=>(F(),E("div",{key:u.id,class:"member-card",onClick:_n=>m.$router.push(`/member/${u.id}`)},[b("img",{src:u.avatar,class:"member-avatar"},null,8,sn),b("div",rn,[b("div",cn,[b("span",dn,P(u.name),1),b("span",{class:Q(["membership-badge",u.membershipType])},P(W(s).membershipTypes[u.membershipType].label),3)]),b("div",un,[b("span",null,P(u.phone),1),n[7]||(n[7]=b("span",{class:"divider"},"|",-1)),b("span",null,P(u.id),1)]),b("div",fn,[b("span",{class:Q(["status-tag",u.status])},P(W(s).statusTypes[u.status].label),3),u.expiryDate?(F(),E("span",mn," 到期："+P(u.expiryDate),1)):$e("",!0)])]),t($,{name:"arrow",class:"arrow-icon"})],8,on))),128))])]),_:1},8,["loading","finished"])]),_:1},8,["modelValue"]),t(re,{show:r.value,"onUpdate:show":n[6]||(n[6]=u=>r.value=u),position:"right",style:{width:"80%",height:"100%"}},{default:C(()=>[b("div",vn,[b("div",hn,[n[9]||(n[9]=b("span",null,"篩選條件",-1)),t(X,{type:"primary",size:"small",plain:"",onClick:c},{default:C(()=>[...n[8]||(n[8]=[T("重置",-1)])]),_:1})]),b("div",bn,[n[14]||(n[14]=b("div",{class:"filter-title"},"會籍類型",-1)),t(se,{modelValue:h.value,"onUpdate:modelValue":n[5]||(n[5]=u=>h.value=u),direction:"horizontal"},{default:C(()=>[t(R,{name:"normal",shape:"square"},{default:C(()=>[...n[10]||(n[10]=[T("普通會員",-1)])]),_:1}),t(R,{name:"silver",shape:"square"},{default:C(()=>[...n[11]||(n[11]=[T("銀級會員",-1)])]),_:1}),t(R,{name:"gold",shape:"square"},{default:C(()=>[...n[12]||(n[12]=[T("金級會員",-1)])]),_:1}),t(R,{name:"enterprise",shape:"square"},{default:C(()=>[...n[13]||(n[13]=[T("企業會員",-1)])]),_:1})]),_:1},8,["modelValue"])]),b("div",gn,[t(X,{type:"primary",block:"",round:"",onClick:_},{default:C(()=>[...n[15]||(n[15]=[T("確認篩選",-1)])]),_:1})])])]),_:1},8,["show"])])}}},En=we(kn,[["__scopeId","data-v-0468cfc7"]]);export{En as default};
